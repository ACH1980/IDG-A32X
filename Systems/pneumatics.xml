<!-- Airbus A320 Electrical -->

<!--
##############################################
# Copyright (c) Joshua Davidson (it0uchpods) #
##############################################
-->

<system name="A320: Electrical">
	<property>/controls/pneumatic/switches/bleedapu</property>
	<property>/systems/failures/bleed-apu</property>
	<property>/controls/pneumatic/switches/xbleed</property>
	<property>/systems/failures/bleed-eng1</property>
	<property>/systems/failures/bleed-eng2</property>
	<property>/systems/pneumatic/bleed2</property>
	<property>/controls/pneumatic/switches/bleed1</property>
	<property>/controls/pneumatic/switches/bleed2</property>
	<property>/systems/pneumatic/eng1-starter</property>
	<property>/systems/pneumatic/eng2-starter</property>
	<property>/controls/pneumatic/switches/groundair</property>
	<property>/systems/failures/pack1</property>
	<property>/systems/failures/pack2</property>
	<property>/controls/pneumatic/switches/pack-flo</property>
	<property>/controls/pneumatic/switches/pack1</property>
	<property>/controls/pneumatic/switches/pack2</property>
	
	<channel name="APU Bleed">
		<switch name="/systems/pneumatic/bleedapu">
			<default value="0"/>
			<test logic="AND" value="36">
				/controls/pneumatic/switches/bleedapu eq 1
				/systems/apu/rpm ge 94.9
				/systems/failures/bleed-apu eq 0
			</test>
			<test logic="AND" value="42">
				/controls/pneumatic/switches/bleedapu eq 0
				/systems/apu/rpm ge 94.9
				/systems/failures/bleed-apu eq 0
			</test>
		</switch>
		
		<lag_filter name="/systems/pneumatic/bleedapu-actual">
			<input>/systems/pneumatic/bleedapu</input>
			<c1>0.45</c1>
		</lag_filter>
	</channel>
	
	<channel name="Ground Air">
		<switch name="/systems/pneumatic/groundair">
			<default value="0"/>
			<test logic="AND" value="39">
				/gear/gear[0]/wow eq 1
				/controls/pneumatic/switches/groundair eq 1
			</test>
		</switch>
	</channel>
	
	<channel name="X-Bleed">
		<switch name="/systems/pneumatic/xbleed">
			<default value="0"/>
			<test logic="AND" value="1">
				/controls/pneumatic/switches/xbleed eq 1
				/systems/pneumatic/bleedapu ge 11
			</test>
			<test value="1">
				/controls/pneumatic/switches/xbleed eq 2
			</test>
		</switch>
	</channel>
	
	<channel name="Left Bleed">
		<switch name="/systems/pneumatic/bleed1">
			<default value="0"/>
			<test logic="AND" value="34">
				/engines/engine[0]/state eq 3
				/systems/failures/bleed-eng1 eq 0
				/controls/pneumatic/switches/bleed1 eq 1
			</test>
			<test logic="AND" value="34">
				/systems/pneumatic/bleed2 ge 11
				/systems/pneumatic/xbleed eq 1
				/engines/engine[0]/state ne 3
			</test>
			<test logic="AND" value="34">
				/systems/pneumatic/bleed2 ge 11
				/systems/pneumatic/xbleed eq 1
				/systems/failures/bleed-eng1 eq 1
			</test>
			<test logic="AND" value="34">
				/systems/pneumatic/bleed2 ge 11
				/systems/pneumatic/xbleed eq 1
				/controls/pneumatic/switches/bleed1 eq 0
			</test>
		</switch>
		
		<lag_filter name="/systems/pneumatic/bleed1-actual">
			<input>/systems/pneumatic/bleed1</input>
			<c1>0.4</c1>
		</lag_filter>
	</channel>
	
	<channel name="Right Bleed">
		<switch name="/systems/pneumatic/bleed2">
			<default value="0"/>
			<test logic="AND" value="34">
				/engines/engine[1]/state eq 3
				/systems/failures/bleed-eng2 eq 0
				/controls/pneumatic/switches/bleed2 eq 1
			</test>
			<test logic="AND" value="34">
				/systems/pneumatic/bleed1 ge 11
				/systems/pneumatic/xbleed eq 1
				/engines/engine[1]/state ne 3
			</test>
			<test logic="AND" value="34">
				/systems/pneumatic/bleed1 ge 11
				/systems/pneumatic/xbleed eq 1
				/systems/failures/bleed-eng2 eq 1
			</test>
			<test logic="AND" value="34">
				/systems/pneumatic/bleed1 ge 11
				/systems/pneumatic/xbleed eq 1
				/controls/pneumatic/switches/bleed2 eq 0
			</test>
		</switch>
		
		<lag_filter name="/systems/pneumatic/bleed2-actual">
			<input>/systems/pneumatic/bleed2</input>
			<c1>0.4</c1>
		</lag_filter>
	</channel>
	
	<channel name="Starting System">
		<switch name="/systems/pneumatic/start-psi">
			<default value="0"/>
			<test logic="OR" value="18">
				/engines/engine[0]/state eq 1
				/engines/engine[0]/state eq 2
				/engines/engine[1]/state eq 1
				/engines/engine[1]/state eq 2
			</test>
		</switch>
		<switch name="/systems/pneumatic/starting">
			<default value="0"/>
			<test logic="AND" value="1">
				/engines/engine[0]/state ne 3
				/controls/engines/engine-start-switch eq 2
				/gear/gear[0]/wow eq 1
			</test>
			<test logic="AND" value="1">
				/engines/engine[1]/state ne 3
				/controls/engines/engine-start-switch eq 2
				/gear/gear[0]/wow eq 1
			</test>
			<test logic="AND" value="1">
				/engines/engine[0]/state ne 3
				/systems/pneumatic/eng1-starter eq 1
				/gear/gear[0]/wow eq 1
			</test>
			<test logic="AND" value="1">
				/engines/engine[1]/state ne 3
				/systems/pneumatic/eng2-starter eq 1
				/gear/gear[0]/wow eq 1
			</test>
		</switch>
	</channel>
	
	<channel name="Left Pack">
		<switch name="/systems/pneumatic/pack1">
			<default value="0"/>
			<test logic="AND" value="/controls/pneumatic/switches/pack-flo">
				/controls/pneumatic/switches/pack1 eq 1
				/systems/pneumatic/starting eq 0
				/systems/failures/pack1 ne 1
				/systems/pneumatic/bleed1 ge 11
			</test>
			<test logic="AND" value="/controls/pneumatic/switches/pack-flo">
				/controls/pneumatic/switches/pack1 eq 1
				/systems/pneumatic/starting eq 0
				/systems/failures/pack1 ne 1
				/systems/pneumatic/bleedapu ge 11
			</test>
			<test logic="AND" value="/controls/pneumatic/switches/pack-flo">
				/controls/pneumatic/switches/pack1 eq 1
				/systems/pneumatic/starting eq 0
				/systems/failures/pack1 ne 1
				/systems/pneumatic/groundair ge 11
			</test>
		</switch>
		
		<lag_filter name="/systems/pneumatic/pack1-actual">
			<input>/systems/pneumatic/pack1</input>
			<c1>0.8</c1>
		</lag_filter>
	</channel>
	
	<channel name="Right Pack">
		<switch name="/systems/pneumatic/pack2">
			<default value="0"/>
			<test logic="AND" value="/controls/pneumatic/switches/pack-flo">
				/controls/pneumatic/switches/pack2 eq 1
				/systems/pneumatic/starting eq 0
				/systems/failures/pack2 ne 1
				/systems/pneumatic/bleed2 ge 11
			</test>
			<test logic="AND" value="/controls/pneumatic/switches/pack-flo">
				/controls/pneumatic/switches/pack2 eq 1
				/systems/pneumatic/starting eq 0
				/systems/failures/pack2 ne 1
				/systems/pneumatic/bleedapu ge 11
				/systems/pneumatic/xbleed eq 1
			</test>
			<test logic="AND" value="/controls/pneumatic/switches/pack-flo">
				/controls/pneumatic/switches/pack2 eq 1
				/systems/pneumatic/starting eq 0
				/systems/failures/pack2 ne 1
				/systems/pneumatic/groundair ge 11
			</test>
		</switch>
		
		<lag_filter name="/systems/pneumatic/pack2-actual">
			<input>/systems/pneumatic/pack2</input>
			<c1>0.8</c1>
		</lag_filter>
	</channel>
</system>
